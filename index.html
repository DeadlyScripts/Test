<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Paste + Image â†’ Catbox</title>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: system-ui, sans-serif;
            background: #0f0f1a; color: #e0e0ff;
            min-height: 100vh; padding: 2rem;
        }
        .container { max-width: 900px; margin: 0 auto; }
        h1 { text-align: center; font-size: 2.5rem; margin-bottom: 0.5rem;
             background: linear-gradient(90deg, #a78bfa, #7dd3fc);
             -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .subtitle { text-align: center; color: #94a3b8; margin-bottom: 2rem; }
        .editor-wrapper { border-radius: 12px; overflow: hidden; background: #1e1e38; border: 1px solid #334155; }
        #codeInput { width: 100%; min-height: 300px; padding: 1.5rem; background: #111827; color: #e0e0ff;
                     font-family: 'Consolas', monospace; font-size: 15px; border: none; resize: vertical; }
        .upload-area { padding: 1rem 1.5rem; background: #172033; border-top: 1px solid #2d3748; display: flex;
                        gap: 1rem; flex-wrap: wrap; align-items: center; }
        label { background: #334155; color: white; padding: 0.6rem 1.2rem; border-radius: 8px; cursor: pointer; }
        label:hover { background: #475569; }
        #thumbnailPreview { max-height: 100px; border-radius: 6px; display: none; }
        .controls { padding: 1rem 1.5rem; background: #172033; border-top: 1px solid #2d3748;
                    display: flex; gap: 1rem; flex-wrap: wrap; align-items: center; }
        button { background: linear-gradient(90deg, #7c3aed, #3b82f6); color: white; border: none;
                 padding: 0.7rem 1.5rem; border-radius: 8px; font-weight: 600; cursor: pointer; }
        button:hover { transform: translateY(-2px); }
        #status { color: #94a3b8; flex: 1; }
        .success { color: #34d399 !important; }
        .error { color: #f87171 !important; }
        footer { margin-top: 3rem; text-align: center; color: #64748b; font-size: 0.9rem; }
        a { color: #a78bfa; }
    </style>
</head>
<body>
<div class="container">
    <h1>Quick Paste + Image</h1>
    <p class="subtitle">Paste code/text + upload image â†’ get shareable Catbox links</p>

    <div class="editor-wrapper">
        <textarea id="codeInput" placeholder="Paste your code / text here..."></textarea>

        <div class="upload-area">
            <label for="fileInput">ðŸ“· Add Image</label>
            <input type="file" id="fileInput" accept="image/*" hidden>
            <img id="thumbnailPreview" alt="Preview">
            <span id="fileName">No image selected</span>
        </div>

        <div class="controls">
            <button id="createBtn">Create & Copy Links</button>
            <span id="status">Ready...</span>
        </div>
    </div>

    <footer>Made with Catbox.moe â€¢ No account needed â€¢ <a href="https://catbox.moe" target="_blank">catbox.moe</a></footer>
</div>

<script>
const textarea = document.getElementById('codeInput');
const fileInput = document.getElementById('fileInput');
const preview = document.getElementById('thumbnailPreview');
const fileNameEl = document.getElementById('fileName');
const btn = document.getElementById('createBtn');
const status = document.getElementById('status');

let selectedFile = null;

fileInput.addEventListener('change', e => {
    selectedFile = e.target.files[0];
    if (selectedFile) {
        fileNameEl.textContent = selectedFile.name;
        preview.src = URL.createObjectURL(selectedFile);
        preview.style.display = 'block';
    }
});

async function uploadToCatbox(file, type = 'file') {
    const formData = new FormData();
    formData.append(type, file);
    formData.append('reqtype', type === 'url' ? 'url' : 'fileupload');

    const res = await fetch('https://catbox.moe/resources/upload.php', {
        method: 'POST',
        body: formData
    });
    return await res.text();
}

async function createPaste() {
    const text = textarea.value.trim();
    status.textContent = 'Uploading...'; status.className = '';

    let imageUrl = '';
    let textUrl = '';

    try {
        // Upload image first if present
        if (selectedFile) {
            imageUrl = await uploadToCatbox(selectedFile);
            if (!imageUrl.startsWith('http')) throw new Error('Image upload failed');
        }

        // Upload text if present
        if (text) {
            const textBlob = new Blob([text], { type: 'text/plain' });
            const textFile = new File([textBlob], 'paste.txt', { type: 'text/plain' });
            textUrl = await uploadToCatbox(textFile);
            if (!textUrl.startsWith('http')) throw new Error('Text upload failed');
        }

        let result = '';
        if (imageUrl) result += `Image: ${imageUrl}\n`;
        if (textUrl) result += `Text/Code: ${textUrl}\n`;

        status.innerHTML = `Done!<br><a href="${imageUrl||textUrl}" target="_blank">${result.trim()}</a>`;
        status.className = 'success';

        navigator.clipboard.writeText(result.trim()).catch(() => {});
    } catch (err) {
        console.error(err);
        status.textContent = 'Error: ' + (err.message || 'Try again');
        status.className = 'error';
    }
}

btn.addEventListener('click', createPaste);
textarea.addEventListener('keydown', e => {
    if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
        e.preventDefault();
        createPaste();
    }
});
</script>
</body>
</html>
